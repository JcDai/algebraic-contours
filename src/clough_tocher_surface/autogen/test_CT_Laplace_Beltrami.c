#include "Clough_Tocher_Laplace_Beltrami.c"
#include <stdio.h>

void test_case(double mcp[10][3], double fcp[10], double val, int quad_dim,
               double quad_pts[][2], double weights[]) {
  double A[10][10];
  int i, j;
  double E;

  compute_elem_matrix_C(mcp, quad_dim, quad_pts, weights, A);

  E = 0;
  for (i = 0; i < 10; i++)
    for (j = 0; j < 10; j++)
      E += A[i][j] * fcp[i] * fcp[j];
  E *= 0.5;
  printf("test value of E, should be %g :%g\n", val, E);
}

int main() {
  double mcp1[10][3] = {{0., 0., 0.},
                        {0., .33333333333333333, 0.},
                        {0., .66666666666666667, 0.},
                        {0., 1., 0.},
                        {.33333333333333333, 0., 0.},
                        {.33333333333333333, .33333333333333333, 0.},
                        {.33333333333333333, .66666666666666667, 0.},
                        {.66666666666666667, 0., 0.},
                        {.66666666666666667, .33333333333333333, 0.},
                        {1., 0., 0.}};
  double fcp1[10] = {0.,
                     .66666666666666667,
                     1.3333333333333333,
                     2.,
                     0.,
                     .50000000000000000,
                     1.,
                     0.,
                     .33333333333333333,
                     1.};
  double val1 = 2.9999999999999976;

  double mcp2[10][3] = {
      {0., 0., 0.},
      {0., .33333333333333333, 0.},
      {0., .66666666666666667, .33333333333333333},
      {0., 1., 1.},
      {.33333333333333333, 0., 0.},
      {.33333333333333333, .33333333333333333, 0.},
      {.33333333333333333, .66666666666666667, .33333333333333333},
      {.66666666666666667, 0., .33333333333333333},
      {.66666666666666667, .33333333333333333, .33333333333333333},
      {1., 0., 1.}};
  double fcp2[10] = {0.,
                     0.,
                     -.33333333333333333,
                     -1.,
                     0.,
                     0.,
                     -.33333333333333333,
                     .33333333333333333,
                     .33333333333333333,
                     1.};
  double val2 = 3.5053934638917602;

  double mcp3[10][3] = {{1., 1., 0.},
                        {1., 2., 0.},
                        {1., 4., .33333333333333333},
                        {1., 8., 1.},
                        {1.6666666666666667, 1., 0.},
                        {1.6666666666666667, 2., 0.},
                        {1.6666666666666667, 4., .33333333333333333},
                        {2.6666666666666667, 1., 0.},
                        {2.6666666666666667, 2., 0.},
                        {4., 1., 1.}};
  double fcp3[10] = {0.,
                     .66666666666666667,
                     1.3333333333333333,
                     2.,
                     0.,
                     .50000000000000000,
                     1.,
                     0.,
                     .33333333333333333,
                     1.};
  double val3 = 0.23052434190581370;

  test_case(mcp1, fcp1, val1, QUAD_DIM, quad_pts, weights);
  test_case(mcp2, fcp2, val2, QUAD_DIM, quad_pts, weights);
  test_case(mcp3, fcp3, val3, QUAD_DIM, quad_pts, weights);
}
